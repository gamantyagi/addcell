{% extends 'clubcell/base_up.html' %}
{% load static %}
{% block content %}
<style>
.notify-badge{
    position: absolute;
    top:10px;
    background:green;
    text-align: center;
    border-radius: 30px 30px 30px 30px;
    color:white;
    padding:5px 10px;
    font-size:20px;
}
</style>

<div class="features-boxed">
        <div class="container">
            <center>
            <div class="intro" style="max-width: 892px;">
                <h1 class="text-center">Welcome {{user.first_name}} {{user.last_name}}</h1>
                <div class="text-center">You can view instructions <a href="#">here</a></div>
            </div></center>
            <div class="filtr-controls"><span  data-filter="all" onclick="window.location.href='{{path}}/student/profile'">Your Profile</span><span class="active" data-filter="1" onclick="window.location.href='{{path}}/student/explore'">Explore</span><span data-filter="2">Recommended</span><span data-filter="3" onclick="window.location.href='{{path}}/student/posts'">Posts</span><span data-filter="3">Trending</span><span data-filter="3">Top list</span></div>

                <div class="row features">
                {% for event in events_todo %}
                    {% if event.registration == True %}
                <div>
                <form >

                <div class="col-sm-6 col-md-4 item" id="dibba"   style="max-width: 341px;margin-bottom: 2em; margin-left: 1em; ">

                    <div class="box" id="box"   style="max-width: 302px;background-color: #f2f2f2;opacity: 1; border: 1px solid #e0ebeb;">
                        <div class="image-box"  ><img class="box-image img-responsive" src='{% static ""%}event.jpg'>{% if event.paid == False %}<span class="notify-badge">free</span>{% endif %}</div>
                        <div class="text-left info-box"   style="width: 300px;">
                            <div onclick="window.location.href='{{path}}/event/{{event.event_uen}}'" style="cursor:pointer;">
                            <h3 class="text-center name" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{event.eventname}}</h3>
                            <p class="description" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{event.breif_about}}</p>
                            <p class="description">Date: {{event.heldon}}<br>fee: {{event.fee}}<br>Type: {{event.get_eventtype_display}}<br>Duty leave: {{event.dl}}</p>
                            </div >
                                {% if event.event_participants.all in user.event_participants.all %}<button type="button"   class="btn-outline-success" style="width:50%;background-color: #e6e600;border:#000000;color:#b32d00;" disabled>In toDo list</button><button type="button"  class="btn-outline-success"  style="width:50%;background-color: #e6e600;border: #b3b300;color:#b32d00;" disabled>Registered</button>{% else %}<button type="button" id="wl{{event.eventUAP}}"   class="btn-outline-success" style="width:50%;">Add Wishlist</button><button type="button"  class="btn-outline-success" value="{{event.event_id}}" id="rg{{event.event_uen}}" style="width:50%;">Register</button>{% endif %}
                        </div>
                    </div>
                </div>
                </form></div>
                    {% endif %}
                {% endfor %}

                </div>
        </div>
    </div>

<style>

form:hover {
          background-color: #F8F8F8;


        }
</style>

<script>
    $(document).ready(function(){
  $(".btn-outline-success").click(function(){
  var elmValue = $(this).attr("value");
  $.ajax({
            url: "{{path}}/student/ajax/ajax_event_register",
            type: "GET",
            data: {
                element: elmValue
            },
            success: function(result) {
            if(result == "wrong"){
               alert("Something gone wrong");
            }
            else if(result == "closed"){
               alert("registration closed, not registered.");
            }
            else if(result == "Already registered"){
               alert("Event already registered.");
            }
            else{
                $("#rg" + result).html("<b>Registered</b>");
                $("#rg" + result).attr("disabled",true);
                $("#rg" + result).css("background-color","green");
                $("#rg" + result).css("color","white");}
                },
            error: function(result){
                alert("something gone wrong");}
            });

  });

});
</script>
{% endblock %}